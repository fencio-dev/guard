version: "1.0"
metadata:
  description: "Canonical vocabulary for semantic security encoding"
  last_updated: "2025-11-15"

vocabulary:
  actions:
    read:
      keywords: [search, query, get, fetch, list, find, select]
      description: "Read operations without side effects"
    write:
      keywords: [create, update, insert, modify, set, upsert]
      description: "Write operations that modify state"
    delete:
      keywords: [delete, remove, drop, destroy, purge, clear]
      description: "Deletion operations"
    export:
      keywords: [export, download, dump, backup, extract]
      description: "Export or extraction operations"
    execute:
      keywords: [execute, run, call, invoke, perform]
      description: "Generic execution fallback"

  actor_types:
    agent: "LLM agent acting autonomously"
    user: "Human user directing the agent"
    service: "External service or API"

  resource_types:
    database:
      keywords: [database, db, sql, nosql, table, collection, query]
      description: "Database resources"
    file:
      keywords: [file, document, pdf, csv, text, storage, archive]
      description: "File system resources"
    api:
      keywords: [api, endpoint, service, http, rest, graphql, gateway]
      description: "API or service resources"

  sensitivity_levels:
    public: "Publicly accessible data"
    internal: "Internal-only data"
    confidential: "Confidential or restricted data"

  volumes:
    single: "Single record or operation"
    bulk: "Batch or bulk operation"

  authn_levels:
    required: "Authentication required"
    not_required: "Authentication not required"

  locations:
    local: "Local or on-premise resource"
    cloud: "Cloud-hosted resource"
    hybrid: "Hybrid deployment"

  params_length_buckets:
    short: "Parameters length is short (≤120 characters)"
    long: "Parameters length is long (>120 characters)"

slots:
  action:
    required_fields:
      - action
      - actor_type
    optional_fields:
      - tool_call

  resource:
    required_fields:
      - resource_type
    optional_fields:
      - resource_location
      - resource_name
      - tool_name
      - tool_method

  data:
    required_fields:
      - sensitivity
      - pii
      - volume
    optional_fields:
      - params_length

  risk:
    required_fields:
      - authn
    optional_fields:
      - rate_limit

templates:
  action:
    format: "action is {action} | actor_type is {actor_type}"
    with_tool_call: "action is {action} | actor_type is {actor_type} | tool_call is {tool_call}"

  resource:
    minimal: "resource_type is {resource_type}"
    with_location: "resource_type is {resource_type} | resource_location is {resource_location}"
    with_name: "resource_type is {resource_type} | resource_name is {resource_name}"
    with_tool: "resource_type is {resource_type} | tool_name is {tool_name} | tool_method is {tool_method}"
    full: "resource_type is {resource_type} | resource_location is {resource_location} | resource_name is {resource_name} | tool_name is {tool_name} | tool_method is {tool_method}"

  data:
    base: "sensitivity is {sensitivity} | pii is {pii} | volume is {volume}"
    with_params: "sensitivity is {sensitivity} | pii is {pii} | volume is {volume} | params_length is {params_length}"

  risk:
    base: "authn is {authn}"
    with_rate_limit: "authn is {authn} | rate_limit is {rate_limit}"

extraction_rules:
  tool_whitelist:
    action:
      instructions: "Extract one action per allowed method and default actor_type to agent."
      field_mapping:
        allowed_methods: action
      defaults:
        actor_type: agent

    resource:
      instructions: "Derive resource_type from tool keywords and include tool_name per allowed_tool_ids."
      field_mapping:
        allowed_tool_ids: tool_name
      inference:
        resource_type: "If tool_name contains any of [database, db, sql, table, collection] → database, else → api"

    data:
      instructions: "Assume whitelisted tools operate on public data without PII unless constraints exist."
      defaults:
        sensitivity: public
        pii: false
        volume: single

    risk:
      instructions: "Authentication is always required for tool calls."
      defaults:
        authn: required

  tool_param_constraint:
    action:
      instructions: "Infer action from tool_id keyword hints; default actor_type to agent."
      field_mapping:
        tool_id: action
      defaults:
        actor_type: agent

    resource:
      instructions: "Set tool_name from tool_id and derive resource_type via keywords."
      field_mapping:
        tool_id: tool_name
        tool_method: tool_method
      inference:
        resource_type: "If tool_id contains [database, db, sql] → database, else → api"

    data:
      instructions: "Map max_len to params_length bucket; default sensitivity to internal when constraint exists."
      field_mapping:
        max_len: params_length
      inference:
        params_length: "If max_len ≤ 120 → short, else → long"
        sensitivity: "If max_len exists and ≤ 120 → internal, else → public"
      defaults:
        pii: false
        volume: single

    risk:
      defaults:
        authn: required

examples:
  tool_whitelist:
    rule:
      allowed_tool_ids: [search_database]
      allowed_methods: [read]

    expected_output:
      action:
        - fields:
            action: read
            actor_type: agent
          anchor: "action is read | actor_type is agent"

      resource:
        - fields:
            resource_type: database
            tool_name: search_database
            tool_method: read
          anchor: "resource_type is database | tool_name is search_database | tool_method is read"

      data:
        - fields:
            sensitivity: public
            pii: false
            volume: single
          anchor: "sensitivity is public | pii is False | volume is single"

      risk:
        - fields:
            authn: required
          anchor: "authn is required"

  tool_param_constraint:
    rule:
      tool_id: search_database
      max_len: 100
      param_name: query

    expected_output:
      action:
        - fields:
            action: read
            actor_type: agent
          anchor: "action is read | actor_type is agent"

      resource:
        - fields:
            resource_type: database
            tool_name: search_database
          anchor: "resource_type is database | tool_name is search_database"

      data:
        - fields:
            sensitivity: internal
            pii: false
            volume: single
            params_length: short
          anchor: "sensitivity is internal | pii is False | volume is single | params_length is short"

      risk:
        - fields:
            authn: required
          anchor: "authn is required"
